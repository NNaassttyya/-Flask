<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CityVibe</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css')}}">
</head>
<body>
<header class="header">
                    <nav class="navbar">
                        <div class="navbar-container">
                            <img src="{{ url_for('static', filename='images/logo.svg') }}" width="50" height="50" alt="Логотип">
                            <a href="#" class="navbar-brand">City vibe</a>
                            <div class="navbar-wrap">
                                <ul class="navbar-menu">
                                    <li><a href="{{ url_for('map') }}"  >Карта</a></li>
                                    <li><a href="{{ url_for('index') }}" >Главная</a></li>
                                    <li><a href="{{ url_for('support') }}">Тех поддержка</a></li>
                                </ul>
                            </div>
                        </div>
                    </nav>
                </header>
    <div class="container-profile">
        <div class="cnt-profile1">
        <div class="profile-header">
            <div class="avatar-container">
                <div class="avatar-placeholder">Загрузите фото</div>
                <img id="avatar" class="avatar" src="" alt="Фото профиля">
                <div class="upload-btn" onclick="document.getElementById('fileInput').click()">Изменить</div>
                <input type="file" id="fileInput" accept="image/*">
            </div>
            <div class="profile-info">
                <h1 class="profile-name" id="userName">Иван Иванов</h1>
                <p class="profile-email" id="userEmail">ivan@example.com</p>
            </div>
        </div>

        <div class="section">
            <h2 class="section-title">Личные данные</h2>
            <div class="form-group">
                <label for="firstName-profile">Имя</label>
                <input type="text-profile" id="firstName" value="Иван">
            </div>
            <div class="form-group">
                <label for="lastName-profile">Фамилия</label>
                <input type="text-profile" id="lastName" value="Иванов">
            </div>
            <div class="form-group">
                <label for="age">Возраст</label>
                <input type="text-profile" id="age" value="30">
            </div>
            <button class="btn btn-primary" id="saveProfileBtn">Сохранить изменения</button>
        </div>

        <div class="section">
            <h2 class="section-title">Избранные заведения</h2>
            <div class="favorites-list" id="favoritesList">
                <!-- Здесь будут заведения -->
                <div class="favorite-item">Panorama</div>
                <div class="favorite-item">Сыроварня</div>
            </div>
        </div>
        </div>
        <div class="cnt-profile2">
        <div class="section">
            <h2 class="section-title">Изменить пароль</h2>
            <div class="form-group">
                <label for="oldPassword">Старый пароль</label>
                <input type="password-profile" id="oldPassword">
            </div>
            <div class="form-group">
                <label for="newPassword">Новый пароль</label>
                <input type="password-profile" id="newPassword">
            </div>
            <div class="form-group">
                <label for="confirmPassword">Повторите новый пароль</label>
                <input type="password-profile" id="confirmPassword">
            </div>
            <button class="btn btn-primary" id="changePasswordBtn">Сменить пароль</button>
        </div>

        <button class="btn btn-danger" id="logoutBtn">Выйти</button>
    </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Загрузка аватарки
            const fileInput = document.getElementById('fileInput');
            const avatar = document.getElementById('avatar');
            const avatarPlaceholder = document.querySelector('.avatar-placeholder');
            
            fileInput.addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(event) {
                        avatar.src = event.target.result;
                        avatar.style.display = 'block';
                        avatarPlaceholder.style.display = 'none';
                    }
                    reader.readAsDataURL(file);
                }
            });

            // Проверяем, есть ли сохраненная аватарка
            const savedAvatar = localStorage.getItem('profileAvatar');
            if (savedAvatar) {
                avatar.src = savedAvatar;
                avatar.style.display = 'block';
                avatarPlaceholder.style.display = 'none';
            }

            // Сохранение данных профиля
            document.getElementById('saveProfileBtn').addEventListener('click', function() {
                const firstName = document.getElementById('firstName-profile').value;
                const lastName = document.getElementById('lastName-profile').value;
                const age = document.getElementById('age').value;
                
                // Обновляем имя в профиле
                document.getElementById('userName').textContent = `${firstName} ${lastName}`;
                
                // Сохраняем в localStorage (в реальном проекте - отправка на сервер)
                localStorage.setItem('profileFirstName', firstName);
                localStorage.setItem('profileLastName', lastName);
                localStorage.setItem('profileAge', age);
                
                if (avatar.src) {
                    localStorage.setItem('profileAvatar', avatar.src);
                }
                
                alert('Изменения сохранены!');
            });

            // Смена пароля
            document.getElementById('changePasswordBtn').addEventListener('click', function() {
                const oldPassword = document.getElementById('oldPassword').value;
                const newPassword = document.getElementById('newPassword').value;
                const confirmPassword = document.getElementById('confirmPassword').value;
                
                if (newPassword !== confirmPassword) {
                    alert('Новые пароли не совпадают!');
                    return;
                }
                
                // Здесь должна быть проверка старого пароля и сохранение нового
                alert('Пароль успешно изменен!');
                
                // Очищаем поля
                document.getElementById('oldPassword').value = '';
                document.getElementById('newPassword').value = '';
                document.getElementById('confirmPassword').value = '';
            });

            // Выход из профиля
            document.getElementById('logoutBtn').addEventListener('click', function() {
                if (confirm('Вы уверены, что хотите выйти?')) {
                    // Очищаем данные авторизации
                    localStorage.removeItem('isLoggedIn');
                    
                    // Перенаправляем на главную
                    window.location.href = 'maincityvibe.html';
                }
            });

            // Загрузка сохраненных данных при открытии страницы
            const savedFirstName = localStorage.getItem('profileFirstName');
            const savedLastName = localStorage.getItem('profileLastName');
            const savedAge = localStorage.getItem('profileAge');
            
            if (savedFirstName) document.getElementById('firstName-profile').value = savedFirstName;
            if (savedLastName) document.getElementById('lastName-profile').value = savedLastName;
            if (savedAge) document.getElementById('age').value = savedAge;
            if (savedFirstName && savedLastName) {
                document.getElementById('userName').textContent = `${savedFirstName} ${savedLastName}`;
            }
        });
    </script>
    <script src="js/main.js"></script>
</body>
</html>
