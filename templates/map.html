<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CityVibe</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"/>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css')}}">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"/>
    <style>
        /* –í—Å–µ –≤–∞—à–∏ —Ç–µ–∫—É—â–∏–µ —Å—Ç–∏–ª–∏ –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π */
        .popup-form {
            padding: 10px;
        }
        .popup-form textarea {
            width: 100%;
            margin-bottom: 10px;
            padding: 5px;
        }
        .popup-form input[type="datetime-local"] {
            width: 100%;
            margin-bottom: 10px;
            padding: 5px;
        }
        .popup-form button {
            background-color: #4CAF50;
            color: white;
            padding: 5px 10px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            width: auto; /* –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∏—Å—Ö–æ–¥–Ω—ã–π —Ä–∞–∑–º–µ—Ä –∫–Ω–æ–ø–∫–∏ */
        }
        .popup-form button:hover {
            background-color: #45a049;
        }

        .venue-marker {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: white;
            border: 3px solid #4CAF50;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        .venue-icon {
            font-size: 20px;
            line-height: 40px;
            text-align: center;
        }

        /* –£–±—Ä–∞–ª–∏ —Å—Ç–∏–ª–∏ –¥–ª—è user-marker, —Ç–∞–∫ –∫–∞–∫ –±–æ–ª—å—à–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º */

        .venue-popup {
            padding: 10px;
        }

        .venue-popup h3 {
            margin: 0 0 10px 0;
            color: #333;
        }

        .venue-popup p {
            margin: 0 0 10px 0;
            color: #666;
        }

        .venue-popup button {
            background-color: #4CAF50;
            color: white;
            padding: 5px 10px; /* –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∏—Å—Ö–æ–¥–Ω—ã–π —Ä–∞–∑–º–µ—Ä –∫–Ω–æ–ø–∫–∏ */
            border: none;
            border-radius: 4px;
            cursor: pointer;
            width: auto; /* –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∏—Å—Ö–æ–¥–Ω—ã–π —Ä–∞–∑–º–µ—Ä –∫–Ω–æ–ø–∫–∏ */
        }

        .venue-popup button:hover {
            background-color: #45a049;
        }

        /* –í–µ—Ä–Ω—É–ª–∏ –∏—Å—Ö–æ–¥–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –ø–æ–∏—Å–∫–∞ */
        .searching-container input[type="textsearch"] {
            width: 200px;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        .searching-container button {
            padding: 8px 15px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-left: 5px;
        }

        /* –û—Å—Ç–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π */
        .filters-panel {
            position: fixed;
            left: -300px;
            top: 0;
            width: 300px;
            height: 100vh;
            background: white;
            padding: 20px;
            box-shadow: 2px 0 5px rgba(0,0,0,0.1);
            overflow-y: auto;
            transition: left 0.3s ease;
            z-index: 1000;
        }

        .filters-panel.show {
            left: 0;
        }

        .filter-section {
            margin-bottom: 20px;
        }

        .filter-section h4 {
            margin: 0 0 10px 0;
            color: #333;
        }

        .filter-option {
            margin: 5px 0;
        }

        .filter-option input {
            margin-right: 8px;
        }

        .filter-actions {
            display: flex;
            justify-content: space-between;
            margin: 20px 0;
        }

        .filter-actions button {
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        .apply-filters {
            background: #4CAF50;
            color: white;
        }

        .reset-filters {
            background: #f0f0f0;
            color: #333;
        }

        .map-filter-screen {
            display: flex;
            height: calc(100vh - 80px);
        }

        .sidebar {
            width: 500px;
            background: white;
            padding: 20px;
            overflow-y: auto;
                height: calc(100vh - 80px);
        }

        .map-filter {
            flex: 1;
            position: relative;
        }

        #map-container {
            height: 100%;
            width: 100%;
        }
        .btn-card {
            background: #4CAF50;
            color: white;
            border: none;

        }

        .btn-card:hover {
            background: #45a049;
        }

        .categories {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .categories-cnt {
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
            padding: 10px;
            border-radius: 8px;
            transition: background 0.2s;
        }

        .categories-cnt:hover {
            background: #f5f5f5;
        }

        .categories-cnt img {
            width: 24px;
            height: 24px;
            margin-bottom: 5px;
        }

        .categories-cnt div {
            font-size: 14px;
        }

        #h3recom {
            margin: 20px 0 15px 0;
            color: #333;
        }
    </style>
</head>
<body>
<!-- –í–µ—Å—å HTML –æ—Å—Ç–∞–µ—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π, –∫–∞–∫ –≤ –≤–∞—à–µ–º –∏—Å—Ö–æ–¥–Ω–æ–º —Ñ–∞–π–ª–µ -->
<header class="header">
    <nav class="navbar">
        <div class="navbar-container">
            <img src="{{ url_for('static', filename='images/logo.svg') }}" width="50" height="50" alt="–õ–æ–≥–æ—Ç–∏–ø">
            <a href="#" class="navbar-brand">City vibe</a>
            <div class="navbar-wrap">
                <ul class="navbar-menu">
                    <li><a href="!#" class="active">–ö–∞—Ä—Ç–∞</a></li>
                    <li><a href="{{ url_for('index') }}">–ì–ª–∞–≤–Ω–∞—è</a></li>
                    <li><a href="{{ url_for('support') }}">–¢–µ—Ö –ø–æ–¥–¥–µ—Ä–∂–∫–∞</a></li>
                </ul>
            </div>
            <a class="entrance" href="#" id="auth-button"
               onclick="document.getElementById('sign-up').style.display='block'">–í–æ–π—Ç–∏</a>

            <div class="sign-up" id="sign-up">
                <span class="close" onclick="document.getElementById('sign-up').style.display='none'">&times;</span>
                <form action="#" class="sign-up-content">
                    <div class="container-sign">
                        <h2>City Vibe</h2>
                        <div class="reg">
                            <button class="social-button">
                                    <span class="social-icon">
                                        <img src="{{ url_for('static', filename='images/reg-vk.svg') }}" alt="VK Logo">
                                    </span>
                                <span class="social-text">–í–∫–æ–Ω—Ç–∞–∫—Ç–µ</span>
                            </button>
                            <button class="social-button">
                                    <span class="social-icon">
                                        <img src="{{ url_for('static', filename='images/reg-google.svg') }}"
                                             alt="Google Logo">
                                    </span>
                                <span class="social-text">Google</span>
                            </button>
                        </div>
                        <h4>–ò–ª–∏</h4>
                        <h4>
                            <button type="button" class="register" onclick="showRegisterForm()">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è
                            </button>
                        </h4>
                        <label for="name">–õ–æ–≥–∏–Ω</label>
                        <input type="name" id="name" name="name" placeholder="–í–∞—à –ª–æ–≥–∏–Ω" required autocomplete="off">

                        <label for="email">–ü–æ—á—Ç–∞</label>
                        <input type="email" id="email" name="email" placeholder="–í–∞—à–∞ –ø–æ—á—Ç–∞" required
                               autocomplete="off">

                        <label for="pass">–ü–∞—Ä–æ–ª—å</label>
                        <input type="password" id="pass" name="pass" placeholder="******" required>

                        <div class="buttons">
                            <button type="button" class="cancelBtn"
                                    onclick="document.getElementById('sign-up').style.display='none'">–ó–∞–∫—Ä—ã—Ç—å
                            </button>
                            <button type="button" class="signUpBtn">–í–æ–π—Ç–∏</button>
                        </div>
                    </div>
                </form>
            </div>

            <div class="sign-up" id="register-form" style="display: none;">
                <span class="close" onclick="closeAllModals()">&times;</span>
                <div class="sign-up-content">
                    <div class="container-sign">
                        <h2>City Vibe</h2>
                        <form class="register-form">
                            <label for="reg-login">–õ–æ–≥–∏–Ω</label>
                            <input type="text" id="reg-login" placeholder="–ü—Ä–∏–¥—É–º–∞–π—Ç–µ –ª–æ–≥–∏–Ω" required>

                            <label for="reg-password">–ü–∞—Ä–æ–ª—å</label>
                            <input type="password" id="reg-password" placeholder="–ü—Ä–∏–¥—É–º–∞–π—Ç–µ –ø–∞—Ä–æ–ª—å" required>

                            <label for="reg-email">–ü–æ—á—Ç–∞</label>
                            <input type="email" id="reg-email" placeholder="–í–∞—à–∞ –ø–æ—á—Ç–∞" required>
                            <div class="buttons">
                                <button type="button" class="cancelBtn" onclick="switchToLogin()">–ù–∞–∑–∞–¥</button>
                                <button type="button" id="auth-button" class="register-btn" onclick="registerUser()">
                                    –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </nav>
</header>

<div class="map-filter-screen">
    <div class="sidebar">
        <div class="searching-container">
            <form>
                <input type="textsearch" placeholder="–ü–æ–∏—Å–∫">
                <button type="submit">
                    <h4>–ù–∞–π—Ç–∏</h4>
                </button>
            </form>
        </div>

        <div class="categories">
            <div class="categories-cnt"><img src="{{ url_for('static', filename='images/forkspoon.svg') }}"
                                             alt="–†–µ—Å—Ç–æ—Ä–∞–Ω—ã"/>
                <div id="rest">–†–µ—Å—Ç–æ—Ä–∞–Ω—ã</div>
            </div>
            <div class="categories-cnt"><img src="{{ url_for('static', filename='images/glass.svg') }}" alt="–ë–∞—Ä—ã"/>
                <div>–ë–∞—Ä—ã</div>
            </div>
            <div class="categories-cnt"><img src="{{ url_for('static', filename='images/dance.svg') }}" alt="–ö–ª—É–±—ã"/>
                <div>–ö–ª—É–±—ã</div>
            </div>
            <div class="categories-cnt" id="filterBtn"><img src="{{ url_for('static', filename='images/filter.svg') }}"
                                                            alt="–§–∏–ª—å—Ç—Ä"/>
                <div>–§–∏–ª—å—Ç—Ä</div>
            </div>
        </div>

        <h3 id="h3recom">–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ</h3>

        <div class="card">
            <div class="card-image-container">
                <div class="card-images" data-index="0">
                    <div class="card-image-map"
                         style="background-image: url('{{ url_for('static', filename='images/panorama1.jpg') }}');"></div>
                </div>
                <span class="heart">‚ù§</span>
            </div>
            <div>
                <h3>Panorama</h3>
                <p>–†–µ—Å—Ç–æ—Ä–∞–Ω —Å –ø–∞–Ω–æ—Ä–∞–º–Ω—ã–º –≤–∏–¥–æ–º –Ω–∞ –≥–æ—Ä–æ–¥. –ï–≤—Ä–æ–ø–µ–π—Å–∫–∞—è –∏ –∞–∑–∏–∞—Ç—Å–∫–∞—è –∫—É—Ö–Ω—è.<br><strong>–°–µ–π—á–∞—Å –∑–¥–µ—Å—å: 12
                    —á–µ–ª–æ–≤–µ–∫</strong></p>
                <a href="{{ url_for('venue_details', venue_id=1) }}" class="btn-card">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</a>
            </div>
        </div>

        <div class="card">
            <div class="card-image-container">
                <div class="card-images" data-index="0">
                    <div class="card-image-map"
                         style="background-image: url('{{ url_for('static', filename='images/syrovarnya1.jpg') }}');"></div>
                </div>
                <span class="heart">‚ù§</span>
            </div>
            <div>
                <h3>–°—ã—Ä–æ–≤–∞—Ä–Ω—è</h3>
                <p>–†–µ—Å—Ç–æ—Ä–∞–Ω –∏—Ç–∞–ª—å—è–Ω—Å–∫–æ–π –∫—É—Ö–Ω–∏ —Å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–º –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ–º —Å—ã—Ä–æ–≤.<br><strong>–°–µ–π—á–∞—Å –∑–¥–µ—Å—å: 8
                    —á–µ–ª–æ–≤–µ–∫</strong></p>
                <button class="btn-card">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</button>
            </div>
        </div>

        <div class="card">
            <div class="card-image-container">
                <div class="card-images" data-index="0">
                    <div class="card-image-map"
                         style="background-image: url('{{ url_for('static', filename='images/ruki-up.webp') }}');"></div>
                </div>
                <span class="heart">‚ù§</span>
            </div>
            <div>
                <h3>–†—É–∫–∏ –í–≤–µ—Ä—Ö –±–∞—Ä</h3>
                <p>–†—É–∫–∏ –í–≤–µ—Ä—Ö –±–∞—Ä - –ø–æ–ø—É–ª—è—Ä–Ω–æ–µ –º–µ—Å—Ç–æ –¥–ª—è –¥–Ω–µ–π —Ä–æ–∂–¥–µ–Ω–∏–π –∏ –≤–µ—Å–µ–ª—ã—Ö –ø—Ä–∞–∑–¥–Ω–∏—á–Ω—ã—Ö –±–∞–Ω–∫–µ—Ç–æ–≤. –î–ª—è –∏–º–µ–Ω–∏–Ω–Ω–∏–∫–æ–≤
                    –¥–µ–π—Å—Ç–≤—É—é—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –≤—ã–≥–æ–¥–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è!<br><strong>–≠—Ç–æ –º–µ—Å—Ç–æ –ø–æ—Å–µ—Ç–∏–ª–∏ –†—É–∫–∏ –≤–≤–µ—Ä—Ö –û—Ç–ø–µ—Ç—ã–µ
                        –ú–æ—à–µ–Ω–Ω–∏–∫–∏, Feduk, –í–∏–Ω—Ç–∞–∂ –∏ –¥—Ä.</strong></p>
                <button class="btn-card">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</button>
            </div>
        </div>

        <div class="card">
            <div class="card-image-container">
                <div class="card-images" data-index="0">
                    <div class="card-image-map"
                         style="background-image: url('{{ url_for('static', filename='images/nebar.jpg') }}');"></div>
                </div>
                <span class="heart">‚ù§</span>
            </div>
            <div>
                <h3>Nebar</h3>
                <p>Nebar ‚Äî –ª–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π –∫–ª—É–± —Å –¥–≤—É–º—è —Ç–∞–Ω—Ü–ø–æ–ª–∞–º–∏: —Å–ª–µ–≤–∞ ‚Äî —Ñ–ª–∏—Ä—Ç –∏ –∫–æ–∫—Ç–µ–π–ª–∏, —Å–ø—Ä–∞–≤–∞ ‚Äî –±–µ–∑—É–º–Ω—ã–µ –≤–µ—á–µ—Ä–∏–Ω–∫–∏
                    –±–µ–∑ –ø—Ä–∞–≤–∏–ª.<br><strong>–≠—Ç–æ –º–µ—Å—Ç–æ –ø–æ—Å–µ—Ç–∏–ª –≤–µ–¥—É—â–∏–π –ï–≥–æ—Ä –ü–∞–Ω–∏–Ω</strong></p>
                <button class="btn-card">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</button>
            </div>
        </div>

        <div class="card">
            <div class="card-image-container">
                <div class="card-images" data-index="0">
                    <div class="card-image-map"
                         style="background-image: url('{{ url_for('static', filename='images/ben-hall.webp') }}');"></div>
                </div>
                <span class="heart">‚ù§</span>
            </div>
            <div>
                <h3>Ben Hall</h3>
                <p>Ben Hall ‚Äî —ç—Ç–æ –±–∞—Ä, –ø–∞–±, –Ω–æ—á–Ω–æ–π –∫–ª—É–± –∏ –±–∞–Ω–∫–µ—Ç–Ω—ã–π –∑–∞–ª, —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–Ω—ã–π –≤ —Ü–µ–Ω—Ç—Ä–µ –≥–æ—Ä–æ–¥–∞. –û–Ω —Å—Ç–∏–ª–∏–∑–æ–≤–∞–Ω
                    –ø–æ–¥ —Å—Ç–∞—Ä—É—é –ê–Ω–≥–ª–∏—é –∏ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç —Å–≤–æ–∏–º –≥–æ—Å—Ç—è–º —à–∏—Ä–æ–∫–∏–π –≤—ã–±–æ—Ä –ø–∏–≤–∞, –∞ —Ç–∞–∫–∂–µ –≤–∫—É—Å–Ω—ã–µ –±—É—Ä–≥–µ—Ä—ã –∏ –∫–∞—Ä—Ç–æ—à–∫—É..<br><strong>–≠—Ç–æ
                        –º–µ—Å—Ç–æ –ø–æ—Å–µ—Ç–∏–ª–∏ –°–µ—Ä–≥–µ–π –ë–∞–±–∫–∏–Ω –∏–∑ ¬´–ü—è—Ç–Ω–∏—Ü—ã¬ª, –ï–≤–≥–µ–Ω–∏–π –ú–∞—Ä–≥—É–ª–∏—Å –∏–∑ ¬´–ú–∞—à–∏–Ω—ã –≤—Ä–µ–º–µ–Ω–∏¬ª –∏ –¥—Ä.</strong>
                </p>
                <button class="btn-card">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</button>
            </div>
        </div>
    </div>

    <div class="filters-panel" id="filtersPanel">
        <div class="filter-section">
            <h4>–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞</h4>
            <div class="filter-actions">
                <button class="apply-filters">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
                <button class="reset-filters">–°–±—Ä–æ—Å–∏—Ç—å</button>
            </div>
        </div>

        <div class="filter-section">
            <div class="filter-option"><input type="radio" name="sort" id="sort1"> <label for="sort1">–û—Ç–∫—Ä—ã—Ç–æ
                —Å–µ–π—á–∞—Å</label></div>
            <div class="filter-option"><input type="radio" name="sort" id="sort2"> <label for="sort2">–° —Å–∞–π—Ç–æ–º</label>
            </div>
            <div class="filter-option"><input type="radio" name="sort" id="sort3"> <label for="sort3">–î–æ—Å—Ç–∞–≤–∫–∞</label>
            </div>
        </div>

        <div class="filter-section">
            <h4>–°—Ä–µ–¥–Ω–∏–π —á–µ–∫</h4>
            <div class="price-range">
                <span>400</span>
                <input type="range" min="400" max="5000" step="100" value="2200" class="slider" id="priceRange">
                <span>5000</span>
            </div>
        </div>

        <div class="filter-section">
            <h4>–í–∏–¥ –∑–∞–≤–µ–¥–µ–Ω–∏—è</h4>
            <div class="filter-option"><input type="checkbox" id="type1"> <label for="type1">–ë–∞—Ä—ã</label></div>
            <div class="filter-option"><input type="checkbox" id="type2"> <label for="type2">–ö–ª—É–±—ã</label></div>
            <div class="filter-option"><input type="checkbox" id="type3"> <label for="type3">–†–µ—Å—Ç–æ—Ä–∞–Ω—ã</label></div>
        </div>

        <div class="filter-section">
            <h4>–ö—É—Ö–Ω—è</h4>
            <div class="filter-option"><input type="checkbox" id="cuisine1"> <label for="cuisine1">–ò—Ç–∞–ª—å—è–Ω—Å–∫–∞—è</label>
            </div>
            <div class="filter-option"><input type="checkbox" id="cuisine2"> <label for="cuisine2">–ê–∑–∏–∞—Ç—Å–∫–∞—è</label>
            </div>
            <div class="filter-option"><input type="checkbox" id="cuisine3"> <label for="cuisine3">–ï–≤—Ä–æ–ø–µ–π—Å–∫–∞—è</label>
            </div>
        </div>

        <div class="filter-section">
            <h4>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ</h4>
            <div class="filter-option"><input type="checkbox" id="extra1"> <label for="extra1">Wi-Fi</label></div>
            <div class="filter-option"><input type="checkbox" id="extra2"> <label for="extra2">Vip-–∑–∞–ª</label></div>
        </div>

        <div class="filter-section">
            <h4>–†–µ–π—Ç–∏–Ω–≥</h4>
            <div class="filter-option"><input type="radio" name="rating" id="rating1"> <label for="rating1">–æ—Ç
                4.5</label></div>
            <div class="filter-option"><input type="radio" name="rating" id="rating2"> <label for="rating2">–æ—Ç
                4.0</label></div>
            <div class="filter-option"><input type="radio" name="rating" id="rating3"> <label for="rating3">–æ—Ç
                3.5</label></div>
            <div class="filter-option"><input type="radio" name="rating" id="rating4"> <label for="rating4">–æ—Ç
                3.0</label></div>
        </div>
    </div>

    <div class="map-filter">
        <div id="map-container"></div>
    </div>
</div>

<footer>
    <nav class="footer-nav">
        <div class="footer-container">
            <div class="footer-grid">
                <div class="nav-section">
                    <h2>–ù–∞–≤–∏–≥–∞—Ü–∏—è</h2>
                    <ul class="footer-menu">
                        <li><a href="{{ url_for('index') }}">–ì–ª–∞–≤–Ω–∞—è</a></li>
                        <li><a href="{{ url_for('map') }}">–ö–∞—Ä—Ç–∞</a></li>
                        <li><a href="{{ url_for('support') }}">–¢–µ—Ö –ø–æ–¥–¥–µ—Ä–∂–∫–∞</a></li>
                    </ul>
                </div>

                <div class="social-section">
                    <h2>–°–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏</h2>
                    <ul class="footer-menu-media">
                        <li><a href="#"><img src="{{ url_for('static', filename='images/tg.svg') }}"></a></li>
                        <li><a href="#"><img src="{{ url_for('static', filename='images/tiktok.svg') }}"></a></li>
                        <li><a href="#"><img src="{{ url_for('static', filename='images/stash_telegram.svg') }}"></a>
                        </li>
                    </ul>
                </div>

                <div class="partners-section">
                    <h2>–ü–∞—Ä—Ç–Ω–µ—Ä–∞–º</h2>
                    <ul class="partners-list">
                        <li><a href="mailto:Cityvibe@gmail.com">Cityvibe@gmail.com</a></li>
                        <li><a href="mailto:Cityvibe@gmail.com">Cityvibe@gmail.com</a></li>
                    </ul>
                </div>

                <div class="contacts-section">
                    <h2>–ö–æ–Ω—Ç–∞–∫—Ç—ã</h2>
                    <ul class="contacts-list">
                        <li><a href="#">–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ</a></li>
                        <li><a href="tel:+79001111111">+7-900-111-11-11</a></li>
                        <li><a href="tel:+79001111111">+7-900-111-11-11</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </nav>
</footer>

<script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
<script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
<script src="{{ url_for('static', filename='js/main.js') }}"></script>

<script>
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞—Ä—Ç—ã
    const currentUserId = {{ current_user_id|default('null')|tojson }};
    let map;
    let tempMarker = null;
    let points = [];
    let venues = [];
    let venueMarkers = [];

    function initMap() {
        // –°–æ–∑–¥–∞–µ–º –∫–∞—Ä—Ç—É –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
        map = L.map('map-container').setView([56.8389, 60.6057], 12);
        const ekaterinburgCoords = [56.8389, 60.6057];

        // –î–æ–±–∞–≤–ª—è–µ–º —Å–ª–æ–π —Å OpenStreetMap
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
}).addTo(map);

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –ø–æ –∫–∞—Ä—Ç–µ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–æ—á–µ–∫
        map.on('click', function(e) {
            if (!currentUserId) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É, —á—Ç–æ–±—ã –¥–æ–±–∞–≤–ª—è—Ç—å —Ç–æ—á–∫–∏');
                return;

            }

            const { lat, lng } = e.latlng;

            // –£–¥–∞–ª—è–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–π –≤—Ä–µ–º–µ–Ω–Ω—ã–π –º–∞—Ä–∫–µ—Ä
            if (tempMarker) {
                map.removeLayer(tempMarker);
            }

            // –°–æ–∑–¥–∞–µ–º —Ñ–æ—Ä–º—É –¥–ª—è –≤–≤–æ–¥–∞ –¥–∞–Ω–Ω—ã—Ö
            const popupContent = `
                <div class="popup-form">
                    <textarea id="point-description" placeholder="–ß—Ç–æ –≤—ã –∑–¥–µ—Å—å –¥–µ–ª–∞–µ—Ç–µ?" rows="3"></textarea>
                    <input type="datetime-local" id="point-end-time">
                    <button onclick="savePoint(${lat}, ${lng})">–î–æ–±–∞–≤–∏—Ç—å —Ç–æ—á–∫—É</button>
                </div>
            `;

            // –î–æ–±–∞–≤–ª—è–µ–º –≤—Ä–µ–º–µ–Ω–Ω—ã–π –º–∞—Ä–∫–µ—Ä
            tempMarker = L.marker([lat, lng], {
                icon: L.divIcon({
                    className: 'venue-marker',
                    html: '<div class="venue-icon">üìç</div>',
                    iconSize: [40, 40]
                })
            }).addTo(map).bindPopup(popupContent).openPopup();
        });

        // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–æ—á–∫–∏ –∏ –∑–∞–≤–µ–¥–µ–Ω–∏—è
        loadPoints();
        loadVenues();

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤
        const filterBtn = document.getElementById('filterBtn');
        const filtersPanel = document.getElementById('filtersPanel');

        if (filterBtn && filtersPanel) {
            filterBtn.addEventListener('click', () => {
                filtersPanel.classList.toggle('show');
            });
        }
    }

    // –§—É–Ω–∫—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ç–æ—á–∫–∏
    async function savePoint(lat, lng) {
        const description = document.getElementById('point-description').value;
        const endTime = document.getElementById('point-end-time').value;

        if (!description || !endTime) {
            alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è');
            return;
        }

        try {
            const response = await fetch('/add_point', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    latitude: lat,
                    longitude: lng,
                    description: description,
                    end_time: endTime
                })
            });

            const result = await response.json();

            if (result.success) {
                // –û–±–Ω–æ–≤–ª—è–µ–º –º–∞—Ä–∫–µ—Ä –ø–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
                tempMarker.setPopupContent(description);
                tempMarker = null;

                // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Ç–æ—á–∫–∏
                loadPoints();
            } else {
                throw new Error(result.error || '–û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞');
            }
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞:', error);
            alert('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–æ—á–∫—É');
        }
    }

    // –ó–∞–≥—Ä—É–∑–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ç–æ—á–µ–∫
    async function loadPoints() {
        try {
            const response = await fetch('/get_points');
            const data = await response.json();

            // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–µ —Ç–æ—á–∫–∏
            points.forEach(point => map.removeLayer(point));
            points = [];

            // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–µ —Ç–æ—á–∫–∏
            data.forEach(point => {
                const marker = L.marker([point.latitude, point.longitude]).bindPopup(`
                    <b>${point.user_login}</b><br>
                    ${point.description}<br>
                    –î–æ: ${new Date(point.end_time).toLocaleString()}<br>
                    ${point.user_id === currentUserId ?
                        `<button onclick="deletePoint(${point.id})" style="margin-top: 5px; padding: 5px 10px; background: #f44336; color: white; border: none; border-radius: 4px; cursor: pointer;">–£–¥–∞–ª–∏—Ç—å</button>` :
                        ''}
                `);
                marker.addTo(map);
                points.push(marker);
            });
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–æ—á–µ–∫:', error);
        }
    }

    // –£–¥–∞–ª–µ–Ω–∏–µ —Ç–æ—á–∫–∏
    async function deletePoint(pointId) {
        if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç—É —Ç–æ—á–∫—É?')) {
            try {
                const response = await fetch(`/delete_point/${pointId}`, {
                    method: 'DELETE'
                });

                if (response.ok) {
                    loadPoints();
                } else {
                    throw new Error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —Ç–æ—á–∫–∏');
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞:', error);
                alert('–ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å —Ç–æ—á–∫—É');
            }
        }
    }

    // –ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–≤–µ–¥–µ–Ω–∏–π
   async function loadVenues() {
try {
    // –ü—Ä–æ–±—É–µ–º –∑–∞–≥—Ä—É–∑–∏—Ç—å –∑–∞–≤–µ–¥–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–∞
    const response = await fetch('/get_venues');
    let venues = [];

    if (response.ok) {
        venues = await response.json();
    } else {
        // –ï—Å–ª–∏ —Å–µ—Ä–≤–µ—Ä –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç, –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
        venues = [
            {
                id: 1,
                name: "Panorama",
                description: "–†–µ—Å—Ç–æ—Ä–∞–Ω —Å –ø–∞–Ω–æ—Ä–∞–º–Ω—ã–º –≤–∏–¥–æ–º –Ω–∞ –≥–æ—Ä–æ–¥",
                venue_type: "restaurant",
                latitude: 56.8350,
                longitude: 60.6123,
                current_visitors: 12
            },
            {
                id: 2,
                name: "–°—ã—Ä–æ–≤–∞—Ä–Ω—è",
                description: "–†–µ—Å—Ç–æ—Ä–∞–Ω –∏—Ç–∞–ª—å—è–Ω—Å–∫–æ–π –∫—É—Ö–Ω–∏",
                venue_type: "restaurant",
                latitude: 56.8421,
                longitude: 60.5987,
                current_visitors: 8
            }
        ];
    }
    // –í —Ñ—É–Ω–∫—Ü–∏–∏ loadVenues(), –ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö:
venues = venues.filter(venue => venue.name !== "Panorama");
    // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–µ –º–∞—Ä–∫–µ—Ä—ã
    venueMarkers.forEach(marker => map.removeLayer(marker));
    venueMarkers = [];

    // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–µ –º–∞—Ä–∫–µ—Ä—ã
    venues.forEach(venue => {
        const marker = L.marker([venue.latitude, venue.longitude], {
            icon: L.divIcon({
                className: `venue-marker ${venue.venue_type}`,
                html: `<div class="venue-icon">${getVenueIcon(venue.venue_type)}</div>`,
                iconSize: [40, 40]
            })
        }).addTo(map).bindPopup(`
            <div class="venue-popup">
                <h3>${venue.name}</h3>
                <p>${venue.description}</p>
                <p><strong>–°–µ–π—á–∞—Å –∑–¥–µ—Å—å: ${venue.current_visitors} —á–µ–ª.</strong></p>
            </div>
        `);

        venueMarkers.push(marker);
    });

} catch (error) {
    console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞–≤–µ–¥–µ–Ω–∏–π:', error);
}
}
    // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Å–µ—Ç–∏—Ç–µ–ª—è –≤ –∑–∞–≤–µ–¥–µ–Ω–∏–µ
    async function addVenueVisitor(venueId) {
        const description = document.getElementById(`venue-description-${venueId}`).value;
        const endTime = document.getElementById(`venue-end-time-${venueId}`).value;

        if (!description || !endTime) {
            alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è');
            return;
        }

        try {
            const response = await fetch('/add_venue_visitor', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    venue_id: venueId,
                    description: description,
                    end_time: endTime
                })
            });

            if (response.ok) {
                loadVenues();
                loadPoints();
            } else {
                throw new Error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –æ—Ç–º–µ—Ç–∫–∏');
            }
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞:', error);
            alert('–ù–µ —É–¥–∞–ª–æ—Å—å –¥–æ–±–∞–≤–∏—Ç—å –æ—Ç–º–µ—Ç–∫—É');
        }
    }

    function getVenueIcon(type) {
        switch(type) {
            case 'restaurant': return 'üç¥';
            case 'bar': return 'üç∏';
            case 'club': return 'üíÉ';
            default: return 'üìç';
        }
    }

    // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤
    function applyFilters() {
        const priceRange = document.getElementById('priceRange').value;
        const rating = document.querySelector('input[name="rating"]:checked')?.id;
        const selectedTypes = [];

        document.querySelectorAll('.filter-section:nth-of-type(4) input:checked').forEach(input => {
            selectedTypes.push(input.id.replace('type', ''));
        });

        // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∑–∞–≤–µ–¥–µ–Ω–∏–π
        venueMarkers.forEach(marker => {
            const shouldShow = selectedTypes.length === 0 ||
                selectedTypes.some(type => marker.options.icon.options.className.includes(type));

            if (shouldShow) {
                marker.addTo(map);
            } else {
                map.removeLayer(marker);
            }
        });

        // –ó–∞–∫—Ä—ã–≤–∞–µ–º –ø–∞–Ω–µ–ª—å —Ñ–∏–ª—å—Ç—Ä–æ–≤
        document.getElementById('filtersPanel').classList.remove('show');
    }

    // –°–±—Ä–æ—Å —Ñ–∏–ª—å—Ç—Ä–æ–≤
    function resetFilters() {
        document.querySelectorAll('.filters-panel input').forEach(input => {
            if (input.type === 'checkbox' || input.type === 'radio') {
                input.checked = false;
            } else if (input.type === 'range') {
                input.value = input.defaultValue;
            }
        });

        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—Å–µ –º–∞—Ä–∫–µ—Ä—ã
        venueMarkers.forEach(marker => marker.addTo(map));

        // –ó–∞–∫—Ä—ã–≤–∞–µ–º –ø–∞–Ω–µ–ª—å —Ñ–∏–ª—å—Ç—Ä–æ–≤
        document.getElementById('filtersPanel').classList.remove('show');
    }

    // –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –¥–ª—è –∫–Ω–æ–ø–æ–∫ —Ñ–∏–ª—å—Ç—Ä–æ–≤
    document.querySelector('.apply-filters')?.addEventListener('click', applyFilters);
    document.querySelector('.reset-filters')?.addEventListener('click', resetFilters);

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞—Ä—Ç—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    document.addEventListener('DOMContentLoaded', initMap);
</script>
</body>
</html>